<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Covermark Valentine's Day</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@200;400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    
    <style>
        body { font-family: 'Prompt', sans-serif; background-color: #fcfcfc; color: #1a1a1a; }
        .page { display: none; min-height: 100vh; flex-direction: column; }
        .page.active { display: flex; }
        .bg-gold { background-color: #B8860B; }
        .text-gold { color: #B8860B; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        /* Swiper Custom */
        .swiper { width: 100%; padding-top: 20px; padding-bottom: 50px; }
        .swiper-slide { background-position: center; background-size: cover; width: 250px; }
        .product-card { transition: transform 0.3s; }
        .swiper-slide-active .product-card { transform: scale(1.1); border: 2px solid #B8860B; }
    </style>
</head>
<body>

    <div id="loader" class="fixed inset-0 z-50 flex flex-col items-center justify-center bg-white">
        <img src="https://img5.pic.in.th/file/secure-sv1/COVERMARK.jpg" alt="Logo" class="w-32 mb-4 animate-pulse">
        <p class="text-sm tracking-widest uppercase">Loading Experience...</p>
    </div>

    <div id="app">
        <section id="page-home" class="page active p-6 flex items-center justify-center text-center">
            <img src="https://img5.pic.in.th/file/secure-sv1/COVERMARK.jpg" class="w-40 mb-10">
            <h1 class="text-xl mb-8">‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡πÅ‡∏î‡πà‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏£‡∏±‡∏Å</h1>
            <button onclick="navigateTo('page-condition')" class="bg-black text-white px-12 py-3 rounded-full uppercase tracking-widest text-sm">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏¢</button>
        </section>

        <section id="page-condition" class="page p-8 flex-col justify-between">
            <div>
                <h2 class="text-lg font-semibold mb-6 text-center">‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</h2>
                <p class="text-sm leading-relaxed text-gray-600">
                    ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏î‡∏•‡∏≠‡∏á ‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡∏ó‡πà‡∏≤‡∏ô‡∏ï‡∏•‡∏≠‡∏î‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç ‡∏´‡∏≤‡∏Å‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏´‡∏°‡∏î ‡∏ó‡∏≤‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø ‡∏Ç‡∏≠‡∏™‡∏á‡∏ß‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÅ‡∏à‡πâ‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤
                </p>
            </div>
            <button onclick="navigateTo('page-sender')" class="bg-black text-white w-full py-4 rounded-full uppercase tracking-widest text-sm mt-10">‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö</button>
        </section>

        <section id="page-sender" class="page p-4">
            <div class="flex justify-between items-center mb-4">
                <span class="text-xs uppercase tracking-widest">Select Gift</span>
                <button id="bgm-btn" onclick="toggleMusic()"><span id="music-icon">üîá</span></button>
            </div>

            <div class="swiper mySwiper">
                <div class="swiper-wrapper" id="product-list">
                    </div>
            </div>

            <div class="space-y-4 mt-4">
                <div>
                    <label class="text-xs text-gray-400">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö</label>
                    <input type="text" id="receiver-name" class="w-full border-b border-gray-300 py-2 focus:border-black outline-none transition-colors">
                </div>
                <div>
                    <label class="text-xs text-gray-400">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á</label>
                    <input type="text" id="sender-name" class="w-full border-b border-gray-300 py-2 focus:border-black outline-none transition-colors">
                </div>
                <div>
                    <label class="text-xs text-gray-400">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏≠‡∏Å‡∏£‡∏±‡∏Å</label>
                    <select id="love-message" class="w-full border-b border-gray-300 py-2 outline-none">
                        <option>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏±‡∏ô‡∏ô‡∏∞</option>
                        <option>‡πÅ‡∏ó‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏à‡∏≤‡∏Å‡πÉ‡∏à</option>
                        <option>‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡∏ß‡∏≤‡πÄ‡∏•‡∏ô‡πÑ‡∏ó‡∏ô‡πå</option>
                        <option>‡∏£‡∏±‡∏Å‡πÄ‡∏ò‡∏≠‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏ô‡∏∞</option>
                    </select>
                </div>
                <button onclick="prepareSummary()" class="w-full bg-black text-white py-4 rounded-full uppercase tracking-widest text-sm">‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            </div>
        </section>

        <section id="page-summary" class="page p-6">
            <h2 class="text-center text-lg mb-8 uppercase tracking-widest">‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç</h2>
            <div id="summary-card" class="bg-white p-6 shadow-xl rounded-lg text-center border border-gray-100">
                <img id="summary-img" src="" class="w-3/4 mx-auto mb-4 rounded shadow">
                <p class="text-sm text-gray-400">To: <span id="sum-receiver" class="text-black font-semibold"></span></p>
                <p id="sum-msg" class="my-4 italic text-gold font-medium"></p>
                <p class="text-xs text-gray-400 text-right">- <span id="sum-sender"></span></p>
            </div>
            <div class="flex gap-4 mt-10">
                <button onclick="navigateTo('page-sender')" class="w-1/2 border border-black py-3 rounded-full text-sm">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                <button onclick="sendGift()" class="w-1/2 bg-black text-white py-3 rounded-full text-sm">‡∏™‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç</button>
            </div>
        </section>
    </div>

    <audio id="bgm" loop src="YOUR_VALENTINE_MUSIC_URL.mp3"></audio>

    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script>
        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
        const products = [
            { id: 1, name: "Product A", img: "https://via.placeholder.com/300x400?text=Product+1", fullImg: "https://via.placeholder.com/600x800?text=Premium+1" },
            { id: 2, name: "Product B", img: "https://via.placeholder.com/300x400?text=Product+2", fullImg: "https://via.placeholder.com/600x800?text=Premium+2" },
            { id: 3, name: "Product C", img: "https://via.placeholder.com/300x400?text=Product+3", fullImg: "https://via.placeholder.com/600x800?text=Premium+3" }
        ];

        let selectedProduct = products[0];
        let isMusicPlaying = false;

        // --- LIFF & NAVIGATION ---
        async function initLiff() {
            try {
                await liff.init({ liffId: "2008756827-zANFfOMQ" });
                if (liff.isLoggedIn()) {
                    const profile = await liff.getProfile();
                    document.getElementById('sender-name').value = profile.displayName;
                } else {
                    liff.login();
                }
            } catch (err) { console.error('LIFF Init Error', err); }
            document.getElementById('loader').style.display = 'none';
        }

        function navigateTo(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active', 'fade-in');
            window.scrollTo(0, 0);
        }

        // --- RENDER PRODUCTS ---
        const swiperWrapper = document.getElementById('product-list');
        products.forEach(p => {
            swiperWrapper.innerHTML += `
                <div class="swiper-slide">
                    <div class="product-card p-2 bg-white rounded shadow-sm">
                        <img src="${p.img}" class="w-full aspect-[3/4] object-cover">
                        <p class="text-center text-xs mt-2">${p.name}</p>
                    </div>
                </div>`;
        });

        const swiper = new Swiper(".mySwiper", {
            effect: "coverflow",
            grabCursor: true,
            centeredSlides: true,
            slidesPerView: "auto",
            loop: true,
            on: {
                slideChange: function () {
                    selectedProduct = products[this.realIndex];
                }
            }
        });

        // --- PREPARE SUMMARY ---
        function prepareSummary() {
            const receiver = document.getElementById('receiver-name').value;
            if (!receiver) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö');
            
            document.getElementById('sum-receiver').innerText = receiver;
            document.getElementById('sum-sender').innerText = document.getElementById('sender-name').value;
            document.getElementById('sum-msg').innerText = `"${document.getElementById('love-message').value}"`;
            document.getElementById('summary-img').src = selectedProduct.img;
            
            navigateTo('page-summary');
        }

        // --- SHARE TARGET PICKER ---
        async function sendGift() {
            const sender = document.getElementById('sender-name').value;
            const receiver = document.getElementById('receiver-name').value;
            const message = document.getElementById('love-message').value;
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á URL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö (‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏õ‡∏ú‡πà‡∏≤‡∏ô Query String)
            const shareUrl = `https://liff.line.me/2008756827-zANFfOMQ?mode=receiver&sender=${encodeURIComponent(sender)}&receiver=${encodeURIComponent(receiver)}&giftId=${selectedProduct.id}&msg=${encodeURIComponent(message)}`;

            try {
                const result = await liff.shareTargetPicker([
                    {
                        "type": "flex",
                        "altText": `‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏à‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì ${sender}`,
                        "contents": {
                            "type": "bubble",
                            "body": {
                                "type": "box", "layout": "vertical", "paddingAll": "0px",
                                "contents": [
                                    {
                                        "type": "box", "layout": "vertical",
                                        "contents": [
                                            { "type": "image", "url": "https://img5.pic.in.th/file/secure-sv1/COVERMARK.jpg", "size": "full", "aspectRatio": "3:4", "aspectMode": "cover" },
                                            {
                                                "type": "box", "layout": "vertical", "position": "absolute", "offsetBottom": "80px", "offsetStart": "0px", "offsetEnd": "0px", "alignItems": "center",
                                                "contents": [
                                                    { "type": "text", "text": `To: ${receiver}`, "weight": "bold", "color": "#ffffff", "size": "md" },
                                                    { "type": "text", "text": message, "color": "#ffffff", "size": "sm" }
                                                ]
                                            },
                                            {
                                                "type": "button", "action": { "type": "uri", "label": "‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç", "uri": shareUrl },
                                                "style": "primary", "color": "#B8860B", "height": "sm", "position": "absolute", "offsetBottom": "20px", "offsetStart": "50px", "offsetEnd": "50px"
                                            }
                                        ]
                                    }
                                ]
                            }
                        }
                    }
                ]);
                if (result) {
                    liff.closeWindow();
                }
            } catch (error) {
                console.error("Error sending message:", error);
            }
        }

        function toggleMusic() {
            const bgm = document.getElementById('bgm');
            if (isMusicPlaying) {
                bgm.pause();
                document.getElementById('music-icon').innerText = 'üîá';
            } else {
                bgm.play();
                document.getElementById('music-icon').innerText = 'üîä';
            }
            isMusicPlaying = !isMusicPlaying;
        }

        initLiff();
    </script>
</body>
</html>